<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Turni</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #2E2E2E;
            color: #EAEAEA;
            margin: 0;
            padding: 2rem;
        }
        h1 {
            text-align: center;
            color: #F1C40F;
            margin-bottom: 1rem;
        }
        .calendar-container {
            max-width: 100%;
            margin: auto;
            overflow: hidden;
            padding: 0 1rem;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #444;
            color: #EAEAEA;
            padding: 0.5rem;
        }
        .calendar-controls button {
            background: #F1C40F;
            border: none;
            color: #2E2E2E;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-weight: bold;
        }
        .calendar-controls button:hover {
            background: #F39C12;
        }
        .calendar-month {
            font-size: 1.5rem;
            font-weight: bold;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #333;
        }
        .calendar-header-day {
            background-color: #444;
            color: #EAEAEA;
            text-align: center;
            padding: 0.5rem;
            font-weight: bold;
        }
        .calendar-day {
            background-color: #555;
            color: #EAEAEA;
            text-align: center;
            padding: 0.5rem;
            min-height: 80px;
            position: relative;
            box-sizing: border-box;
        }
        .calendar-day.sun, .calendar-day.holiday {
            background-color: #E74C3C;
            color: white;
        }
        .calendar-day.event-giornaliero {
            background-color: #F1C40F;
        }
        .calendar-day.event-pomeriggio {
            background-color: #8A2BE2; /* Viola per il turno pomeridiano */
        }
        .calendar-day.event-mattino {
            background-color: #00BFFF;
        }
        .calendar-day::after {
            content: attr(data-event);
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
            background: rgba(0, 0, 0, 0.5);
            color: #EAEAEA;
            padding: 0.2rem;
            font-size: 0.8rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        @media (max-width: 768px) {
            .calendar {
                grid-template-columns: repeat(7, 1fr);
            }
            .calendar-day {
                min-height: 60px;
                font-size: 0.8rem;
                padding: 0.3rem;
            }
            .calendar-day::after {
                font-size: 0.7rem;
                padding: 0.1rem;
            }
        }
        @media (max-width: 480px) {
            .calendar {
                grid-template-columns: repeat(7, 1fr);
                gap: 0;
            }
            .calendar-day {
                min-height: 50px;
                font-size: 0.7rem;
                padding: 0.2rem;
            }
            .calendar-day::after {
                font-size: 0.6rem;
                padding: 0.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="calendar-container">
        <h1>Calendario Turni</h1>
        <div class="calendar-header">
            <button id="prev-month">« Mese Precedente</button>
            <div class="calendar-month" id="month-year"></div>
            <button id="next-month">Mese Successivo »</button>
        </div>
        <div class="calendar" id="calendar">
            <!-- Intestazioni dei giorni della settimana -->
            <div class="calendar-header-day">Lun</div>
            <div class="calendar-header-day">Mar</div>
            <div class="calendar-header-day">Mer</div>
            <div class="calendar-header-day">Gio</div>
            <div class="calendar-header-day">Ven</div>
            <div class="calendar-header-day">Sab</div>
            <div class="calendar-header-day">Dom</div>
            <!-- Le caselle dei giorni saranno inserite dinamicamente dallo script -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calendarEl = document.getElementById('calendar');
            const prevMonthButton = document.getElementById('prev-month');
            const nextMonthButton = document.getElementById('next-month');
            const monthYearEl = document.getElementById('month-year');

            let currentMonth = new Date();
            currentMonth.setDate(1); // Inizia dal primo giorno del mese

            const holidays = ['2024-12-25', '2024-01-01']; // Esempio di festività (Natale e Capodanno)

            function isHoliday(date) {
                return holidays.includes(date.toISOString().split('T')[0]);
            }

            function renderCalendar() {
                calendarEl.innerHTML = `
                    <div class="calendar-header-day">Lun</div>
                    <div class="calendar-header-day">Mar</div>
                    <div class="calendar-header-day">Mer</div>
                    <div class="calendar-header-day">Gio</div>
                    <div class="calendar-header-day">Ven</div>
                    <div class="calendar-header-day">Sab</div>
                    <div class="calendar-header-day">Dom</div>
                `;

                const firstDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
                const lastDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);
                const dayOfWeek = firstDayOfMonth.getDay();
                const totalDays = lastDayOfMonth.getDate();

                // Crea celle vuote per i giorni precedenti
                for (let i = 0; i < (dayOfWeek + 6) % 7; i++) {
                    calendarEl.innerHTML += '<div class="calendar-day"></div>';
                }

                // Aggiungi giorni del mese
                for (let i = 1; i <= totalDays; i++) {
                    const dayElement = document.createElement('div');
                    const dayClass = (new Date(currentMonth.getFullYear(), currentMonth.getMonth(), i).getDay() === 0) ? 'sun' : '';
                    dayElement.className = `calendar-day ${dayClass}`;
                    dayElement.textContent = i;

                    // Gestisci le festività
                    if (isHoliday(new Date(currentMonth.getFullYear(), currentMonth.getMonth(), i))) {
                        dayElement.classList.add('holiday');
                    }

                    // Aggiungi eventi
                    const currentDateISO = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), i).toISOString().split('T')[0];
                    const daysSinceStart = (new Date(currentDateISO) - new Date('2024-09-01')) / (24 * 60 * 60 * 1000);

                    let turnType = '';
                    if (daysSinceStart % 21 === 0) {
                        turnType = 'Giornaliero';
                    } else if (daysSinceStart % 21 === 7) {
                        turnType = 'Pomeriggio';
                    } else if (daysSinceStart % 21 === 14) {
                        turnType = 'Mattino';
                    }

                    if (turnType === 'Giornaliero') {
                        for (let j = 0; j < 7; j++) { // Giorni del turno giornaliero
                            if (i + j <= totalDays) {
                                const dayElement = calendarEl.children[(dayOfWeek + i - 1 + j) % 7];
                                dayElement.classList.add('event-giornaliero');
                                dayElement.setAttribute('data-event', 'Giornaliero');
                            }
                        }
                    } else if (turnType === 'Pomeriggio') {
                        for (let j = 0; j < 5; j++) { // Giorni del turno pomeridiano
                            if (i + j <= totalDays) {
                                const dayElement = calendarEl.children[(dayOfWeek + i - 1 + j) % 7];
                                dayElement.classList.add('event-pomeriggio');
                                dayElement.setAttribute('data-event', 'Pomeriggio');
                            }
                        }
                    } else if (turnType === 'Mattino') {
                        for (let j = 0; j < 6; j++) { // Giorni del turno mattutino
                            if (i + j <= totalDays) {
                                const dayElement = calendarEl.children[(dayOfWeek + i - 1 + j) % 7];
                                dayElement.classList.add('event-mattino');
                                dayElement.setAttribute('data-event', 'Mattino');
                            }
                        }
                    }

                    calendarEl.appendChild(dayElement);
                }

                monthYearEl.textContent = `${currentMonth.toLocaleString('default', { month: 'long' })} ${currentMonth.getFullYear()}`;
            }

            prevMonthButton.addEventListener('click', function() {
                currentMonth.setMonth(currentMonth.getMonth() - 1);
                renderCalendar();
            });

            nextMonthButton.addEventListener('click', function() {
                currentMonth.setMonth(currentMonth.getMonth() + 1);
                renderCalendar();
            });

            renderCalendar();
        });
    </script>
</body>
</html>
